

> 💡 `SYSTEM` 유저를 이용한 작업
> * 계정명 : 
> * 암호 : `보안` -> 불편하게 만드는 게 보안
> * 권한 : 최소 권한의 원칙
> * 공간사용 : 최소 공간의 원칙
> * 프로파일 : 

### 사용자 정보 조회 명령문

```PLSQL
--계정확인
SELECT * 
FORM DBA_USERS
ORDER BY ACCOUNT_STATUS DESC, USERNAME;
```

### 데이터베이스에 있는 데이터 파일에 대한 정보 제공

```PLSQL
--시스템 유저로 접속
--공간 확인
SELECT * 
FROM DBA_DATA_FILES;
```

### 권한확인

```PLSQL
--권한확인
SELECT DISTINCT PRIVILEGE
FROM DBA_SYS_PRIVS
ORDER BY 1;
```

### ROLES 확인

```PLSQL
--그룹별로 역할을 나누어 권한 관리
SELECT * FROM DBA_ROLES;
```

### DBA_PROFILE 확인

```PLSQL
--
SELECT * FROM
DBA_PROFILES
ORDER BY profile, RESOURCE_TYPE;
```

```PLSQL
결과::
DEFAULT	CONNECT_TIME	KERNEL	UNLIMITED
DEFAULT	PRIVATE_SGA	KERNEL	UNLIMITED
DEFAULT	LOGICAL_READS_PER_CALL	KERNEL	UNLIMITED
DEFAULT	LOGICAL_READS_PER_SESSION	KERNEL	UNLIMITED
DEFAULT	CPU_PER_CALL	KERNEL	UNLIMITED
DEFAULT	CPU_PER_SESSION	KERNEL	UNLIMITED
DEFAULT	SESSIONS_PER_USER	KERNEL	UNLIMITED
DEFAULT	COMPOSITE_LIMIT	KERNEL	UNLIMITED
DEFAULT	IDLE_TIME	KERNEL	UNLIMITED
DEFAULT	PASSWORD_REUSE_TIME	PASSWORD	UNLIMITED
DEFAULT	PASSWORD_LIFE_TIME	PASSWORD	180
DEFAULT	PASSWORD_VERIFY_FUNCTION	PASSWORD	NULL
DEFAULT	INACTIVE_ACCOUNT_TIME	PASSWORD	365
DEFAULT	PASSWORD_REUSE_MAX	PASSWORD	UNLIMITED
DEFAULT	PASSWORD_GRACE_TIME	PASSWORD	7
DEFAULT	FAILED_LOGIN_ATTEMPTS	PASSWORD	10
DEFAULT	PASSWORD_LOCK_TIME	PASSWORD	1
DEFAULT	PASSWORD_ROLLOVER_TIME	PASSWORD	0
```


---

# User, Privilege, Role, Profile

## `SYSTEM USER` 

```PLSQL
--(필요시)테이블 스페이스 생성
SELECT NAME FROM V$DATAFILE;
CREATE TABLESPACE MYTBS
DATAFILE 'C:\APP\KOSA\PRODUCT\21C\ORADATA\XE\XEPDB1\MYTBS01.DBF' SIZE 100M;



DECLARE 
V_PATH VARCHAR2(100); 
BEGIN
SELECT SUBSTR(NAME, 1, INSTR(NAME, '\', -1) ) AS PATH
INTO V_PATH
FROM V$DATAFILE
WHERE NAME LIKE '%SYSTEM01%';
DBMS_OUTPUT.PUT_LINE(V_PATH);
EXECUTE IMMEDIATE 'CREATE TABLESPACE MYTBS DATAFILE'''||V_PATH||'MYTBS01.DBF'' SIZE 100M';
END;
/

```

```PLSQL
--(2)필요시 ROLE 생성
DROP ROLE DEV_ROLE;
CREATE ROLE DEV_ROLE;
GRANT CREATE SESSION, CREATE TABLE 
TO DEV_ROLE;
```

```PLSQL
-- 권한(SELECT) 수여 
GRANT SELECT 
ON ACE01.EMP
TO DEV_ROLE;
```

```PLSQL
-- (4)필요시 PROFILE 생성
CREATE PROFILE DEV_PROFILE LIMIT
FAILED_LOGIN_ATTEMPTS 3
SESSIONS_PER_USER 3;
-- 사용자가 동시에 생성할 수 있는 세션(session)의 최대 수를 제한
```

* [PROFILE 참조](https://docs.oracle.com/en/database/oracle/oracle-database/23/sqlrf/CREATE-PROFILE.html)


```PLSQL
-- USER 생성
    CREATE USER TIME
    IDENTIFIED BY INOUT
    DEFAULT TABLESPACE USERS
    QUOTA 5M ON USERS
    QUOTA UNLIMITED ON MYTBS
    PROFILE DEV_PROFILE
    PASSWORD EXPIRE; -- 비밀번호 만기옵션
    
    -- TIME 계정에 DEV_ROLE 부여
    GRANT DEV_ROLE
    TO TIME;
```

## `TIME USER`
```SQL
--SQLPLUS 접속
TIME/INOUT@LOCALHOST:1521/XEPDB1;

--비밀번호가 만기되었습니다.
--새로운 비밀번호 입력

SHOW USER ;
CREATE TABLE T1 (NO NUMBER);
INSERT INTO T1 VALUES(1000);
INSERT INTO T1 VALUES(2000);
COMMIT;
```

```PLSQL
--다른 유저에게 권한부여
GRANT SELECT, INSERT 
ON T1 
TO ACE02, ACE03; 

SELECT * FROM TAB;
```

> 💡 `T1` 테이블에 대한 권한을 `ACE02`, `ACE03` 유저에게 준다.

## `ACE02 USER`

```PLSQL
-- ACE02 유저로 접속
show user ;
select tname from tab; 
select * from time.t1;
```

```PLSQL
결과::
1000
2000
```
